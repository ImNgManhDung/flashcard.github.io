<!DOCTYPE html>
<html lang="vi">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>App h·ªçc t·ª´ v·ª±ng</title>
  <style>
    /* Chung cho t·∫•t c·∫£ c√°c m√†n h√¨nh */
    body {
      font-family: Arial, sans-serif;
      background: #eef2f5;
      padding: 30px;
      text-align: center;
      margin: 0;
      box-sizing: border-box;
    }

    h1 {
      font-size: 24px;
      margin-bottom: 20px;
    }

    .card-container {
      position: relative;
      width: 90%;
      max-width: 300px;
      margin: 20px auto;
      height: 200px;
      overflow: hidden;
    }

    .card {
      width: 100%;
      height: 100%;
      background: #fff;
      border-radius: 12px;
      box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      padding: 20px;
      cursor: pointer;
      transition: transform 0.3s;
      position: absolute;
      top: 0;
      left: 0;
      display: flex;
      flex-direction: column;
      justify-content: center;
      box-sizing: border-box;
      user-select: none;
    }

    .card-controls {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 5px;
    }

    .control-btn {
      background: #f8f9fa;
      border: none;
      border-radius: 50%;
      width: 32px;
      height: 32px;
      cursor: pointer;
      font-size: 14px;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all 0.2s;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
    }

    .control-btn:hover {
      background: #e9ecef;
      transform: scale(1.1);
    }

    .control-btn.learned {
      background: #28a745;
      color: white;
    }

    .control-btn.copy {
      background: #007acc;
      color: white;
    }

    .card:hover {
      transform: scale(1.03);
    }

    .word {
      font-size: 28px;
      font-weight: bold;
      color: #007acc;
    }

    .meaning {
      margin-top: 10px;
      font-size: 20px;
      color: #444;
    }

    .example {
      margin-top: 10px;
      font-style: italic;
      color: #666;
    }

    .word-type {
      margin-top: 8px;
      font-size: 14px;
      color: #fff;
      background: #007acc;
      border-radius: 15px;
      padding: 3px 10px;
      display: inline-block;
    }

    .word-type.noun { background: #28a745; }
    .word-type.verb { background: #dc3545; }
    .word-type.adjective { background: #ffc107; color: #000; }
    .word-type.adverb { background: #6f42c1; }
    .word-type.preposition { background: #fd7e14; }
    .word-type.conjunction { background: #20c997; }
    .word-type.interjection { background: #e83e8c; }

    .status {
      margin-top: 15px;
      font-size: 14px;
      color: green;
    }

    .buttons {
      margin-top: 20px;
    }

    button {
      margin: 5px;
      padding: 10px 20px;
      font-size: 16px;
    }

    .swipe-hint {
      margin-top: 10px;
      font-size: 14px;
      color: #888;
    }

    /* Media Query cho thi·∫øt b·ªã di ƒë·ªông */
    @media (max-width: 600px) {
      h1 {
        font-size: 20px;
      }

      .card-container {
        width: 95%;
      }

      .card {
        padding: 15px;
      }

      .word {
        font-size: 24px;
      }

      .meaning {
        font-size: 18px;
      }

      .example {
        font-size: 16px;
      }

      .status {
        font-size: 12px;
      }

      button {
        padding: 8px 16px;
        font-size: 14px;
      }
    }
  </style>
</head>

<body>

  <h1>üí° T·ª´ v·ª±ng m·ªói ng√†y</h1>

  <div class="card-container">
    <div class="card" id="card" ontouchstart="handleTouchStart(event)" ontouchmove="handleTouchMove(event)" ontouchend="handleTouchEnd(event)" onclick="flipCard(event)">
      <div class="card-controls">
        <button class="control-btn" id="learnBtn" onclick="toggleLearned(event)" title="ƒê√°nh d·∫•u ƒë√£ h·ªçc">‚óã</button>
        <button class="control-btn copy" onclick="copyWord(event)" title="Sao ch√©p t·ª´">üìã</button>
      </div>
      <div class="word" id="word">ƒêang t·∫£i...</div>

      <div class="word-type" id="wordType"></div>
      <div class="meaning" id="meaning"></div>
      <div class="example" id="example"></div>
    </div>
  </div>

  <div class="buttons">
    <!-- Removed the "ƒê√£ h·ªçc" button as it's now integrated into the card -->
  </div>

  <div class="status" id="status"></div>
  <!-- Removed swipe hint -->

  <script>
    let vocabulary = [];
    let currentIndex = 0;
    let flipped = false;

    // Touch/swipe variables
    let startX = 0;
    let startY = 0;
    let currentX = 0;
    let currentY = 0;
    let isDragging = false;
    let cardEl = null;

    const wordEl = document.getElementById("word");
    const meaningEl = document.getElementById("meaning");
    const exampleEl = document.getElementById("example");
    const statusEl = document.getElementById("status");
    const wordTypeEl = document.getElementById("wordType");
    const learnBtnEl = document.getElementById("learnBtn");

    // H·ªá th·ªëng ph√¢n lo·∫°i lo·∫°i t·ª´
    const wordTypePatterns = {
      noun: {
        name: "Danh t·ª´",
        class: "noun",
        patterns: [
          /tion$/i, /sion$/i, /ment$/i, /ness$/i, /ity$/i, /ity$/i,
          /ism$/i, /ist$/i, /er$/i, /or$/i, /ship$/i, /hood$/i,
          /ance$/i, /ence$/i, /ing$/i, /ful$/i, /dom$/i, /age$/i
        ],
        keywords: ['person', 'place', 'thing', 'idea', 'concept']
      },
      verb: {
        name: "ƒê·ªông t·ª´",
        class: "verb",
        patterns: [
          /ed$/i, /ing$/i, /ize$/i, /ise$/i, /fy$/i, /ate$/i,
          /en$/i
        ],
        keywords: ['action', 'do', 'make', 'go', 'come', 'run', 'walk']
      },
      adjective: {
        name: "T√≠nh t·ª´",
        class: "adjective",
        patterns: [
          /ful$/i, /less$/i, /ous$/i, /ious$/i, /eous$/i, /ive$/i,
          /able$/i, /ible$/i, /al$/i, /ic$/i, /ical$/i, /ish$/i,
          /y$/i, /ed$/i, /ing$/i, /ent$/i, /ant$/i, /ary$/i
        ],
        keywords: ['describe', 'quality', 'characteristic']
      },
      adverb: {
        name: "Tr·∫°ng t·ª´",
        class: "adverb",
        patterns: [
          /ly$/i, /ward$/i, /wise$/i
        ],
        keywords: ['how', 'when', 'where', 'manner', 'degree']
      },
      preposition: {
        name: "Gi·ªõi t·ª´",
        class: "preposition",
        commonWords: [
          'in', 'on', 'at', 'by', 'for', 'with', 'without', 'through',
          'during', 'before', 'after', 'above', 'below', 'under', 'over',
          'between', 'among', 'against', 'toward', 'towards', 'into',
          'onto', 'upon', 'within', 'throughout', 'beneath', 'beside',
          'besides', 'beyond', 'across', 'along', 'around', 'behind',
          'inside', 'outside', 'despite', 'except', 'regarding', 'concerning'
        ]
      },
      conjunction: {
        name: "Li√™n t·ª´",
        class: "conjunction",
        commonWords: [
          'and', 'but', 'or', 'nor', 'for', 'so', 'yet', 'although',
          'because', 'since', 'while', 'when', 'where', 'if', 'unless',
          'until', 'before', 'after', 'as', 'than', 'though', 'whether',
          'however', 'therefore', 'moreover', 'furthermore', 'nevertheless'
        ]
      },
      interjection: {
        name: "Th√°n t·ª´",
        class: "interjection",
        commonWords: [
          'oh', 'ah', 'wow', 'hey', 'hello', 'hi', 'bye', 'oops',
          'ouch', 'hooray', 'yay', 'alas', 'bravo', 'darn', 'gosh',
          'hmm', 'huh', 'phew', 'shh', 'ugh', 'whoa', 'yikes'
        ]
      }
    };

    function detectWordType(word, meaning, example) {
      const wordLower = word.toLowerCase();
      
      // Ki·ªÉm tra t·ª´ ph·ªï bi·∫øn tr∆∞·ªõc
      for (const [type, data] of Object.entries(wordTypePatterns)) {
        if (data.commonWords && data.commonWords.includes(wordLower)) {
          return { type: data.name, class: data.class };
        }
      }
      
      // Ki·ªÉm tra pattern t·ª´ suffix
      for (const [type, data] of Object.entries(wordTypePatterns)) {
        if (data.patterns) {
          for (const pattern of data.patterns) {
            if (pattern.test(word)) {
              return { type: data.name, class: data.class };
            }
          }
        }
      }
      
      // Ki·ªÉm tra t·ª´ nghƒ©a v√† v√≠ d·ª•
      const meaningLower = meaning.toLowerCase();
      const exampleLower = example.toLowerCase();
      
      // ƒê·ªông t·ª´ - t√¨m "to" trong v√≠ d·ª• ho·∫∑c nghƒ©a c√≥ d·∫•u hi·ªáu h√†nh ƒë·ªông
      if (exampleLower.includes(' to ' + wordLower) || 
          meaningLower.includes('h√†nh ƒë·ªông') || 
          meaningLower.includes('l√†m') || 
          meaningLower.includes('th·ª±c hi·ªán')) {
        return { type: "ƒê·ªông t·ª´", class: "verb" };
      }
      
      // T√≠nh t·ª´ - m√¥ t·∫£ ƒë·∫∑c ƒëi·ªÉm
      if (meaningLower.includes('t√≠nh') || 
          meaningLower.includes('ƒë·∫∑c ƒëi·ªÉm') || 
          meaningLower.includes('ch·∫•t l∆∞·ª£ng') ||
          exampleLower.includes(' is ' + wordLower) ||
          exampleLower.includes(' very ' + wordLower)) {
        return { type: "T√≠nh t·ª´", class: "adjective" };
      }
      
      // Tr·∫°ng t·ª´ - m√¥ t·∫£ c√°ch th·ª©c
      if (meaningLower.includes('c√°ch') || 
          meaningLower.includes('th·ª©c') ||
          exampleLower.includes(' ' + wordLower + 'ly')) {
        return { type: "Tr·∫°ng t·ª´", class: "adverb" };
      }
      
      // M·∫∑c ƒë·ªãnh l√† danh t·ª´
      return { type: "Danh t·ª´", class: "noun" };
    }

    function shuffle(array) {
      for (let i = array.length - 1; i > 0; i--) {
        const j = Math.floor(Math.random() * (i + 1));
        [array[i], array[j]] = [array[j], array[i]];
      }
    }

    function loadCard(index) {
      const word = vocabulary[index];
      const wordType = detectWordType(word.word, word.meaning, word.example);
      
      wordEl.textContent = word.word;
      wordTypeEl.textContent = wordType.type;
      wordTypeEl.className = `word-type ${wordType.class}`;
      
      meaningEl.textContent = flipped ? word.meaning : '';
      exampleEl.textContent = flipped ? word.example : '';

      // ·∫®n/hi·ªán lo·∫°i t·ª´ theo tr·∫°ng th√°i flip
      wordTypeEl.style.display = flipped ? 'inline-block' : 'none';

      const learned = JSON.parse(localStorage.getItem("learnedWords") || "[]");
      const isLearned = learned.includes(word.word);
      
      // C·∫≠p nh·∫≠t n√∫t h·ªçc
      learnBtnEl.textContent = isLearned ? "‚úì" : "‚óã";
      learnBtnEl.className = isLearned ? "control-btn learned" : "control-btn";
      
      if (isLearned) {
        statusEl.textContent = "‚úÖ B·∫°n ƒë√£ h·ªçc t·ª´ n√†y.";
      } else {
        statusEl.textContent = "üîî B·∫°n ch∆∞a h·ªçc t·ª´ n√†y.";
      }
    }

    function flipCard(event) {
      // Kh√¥ng flip n·∫øu click v√†o control buttons
      if (event && event.target.closest('.card-controls')) {
        return;
      }
      
      if (!isDragging) {
        flipped = !flipped;
        loadCard(currentIndex);
       
      }
    }

 




    function toggleLearned(event) {
      event.stopPropagation();
      const word = vocabulary[currentIndex].word;
      let learned = JSON.parse(localStorage.getItem("learnedWords") || "[]");
      
      if (learned.includes(word)) {
        // B·ªè ƒë√°nh d·∫•u ƒë√£ h·ªçc
        learned = learned.filter(w => w !== word);
      } else {
        // ƒê√°nh d·∫•u ƒë√£ h·ªçc
        learned.push(word);
      }
      
      localStorage.setItem("learnedWords", JSON.stringify(learned));
      loadCard(currentIndex);
    }

    function copyWord(event) {
      event.stopPropagation();
      const word = vocabulary[currentIndex];
      const textToCopy = word.word; // Ch·ªâ copy t·ª´ v·ª±ng
      
      navigator.clipboard.writeText(textToCopy).then(() => {
        // Hi·ªÉn th·ªã th√¥ng b√°o ng·∫Øn
        const copyBtn = event.target;
        const originalText = copyBtn.textContent;
        copyBtn.textContent = "‚úì";
        copyBtn.style.background = "#28a745";
        
        setTimeout(() => {
          copyBtn.textContent = originalText;
          copyBtn.style.background = "#007acc";
        }, 1000);
      }).catch(err => {
        console.error('Kh√¥ng th·ªÉ sao ch√©p:', err);
      });
    }

    function nextCard() {
      if (vocabulary.length === 0) return;
      currentIndex = (currentIndex + 1) % vocabulary.length;
      flipped = false;
      loadCard(currentIndex);
    }

    function prevCard() {
      if (vocabulary.length === 0) return;
      currentIndex = (currentIndex - 1 + vocabulary.length) % vocabulary.length;
      flipped = false;
      loadCard(currentIndex);
    }

    // Touch handlers
    function handleTouchStart(event) {
      startX = event.touches[0].clientX;
      startY = event.touches[0].clientY;
      currentX = startX;
      currentY = startY;
      isDragging = false;
      cardEl = event.target.closest('.card');
    }

    function handleTouchMove(event) {
      if (!cardEl) return;
      
      event.preventDefault();
      currentX = event.touches[0].clientX;
      currentY = event.touches[0].clientY;
      
      const diffX = currentX - startX;
      const diffY = currentY - startY;
      
      // Ch·ªâ x·ª≠ l√Ω swipe ngang n·∫øu di chuy·ªÉn ngang nhi·ªÅu h∆°n d·ªçc
      if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 10) {
        isDragging = true;
        cardEl.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
        cardEl.style.opacity = 1 - Math.abs(diffX) / 300;
      }
    }

    function handleTouchEnd(event) {
      if (!cardEl) return;
      
      const diffX = currentX - startX;
      const threshold = 80;
      
      if (Math.abs(diffX) > threshold) {
        // Swipe ƒë·ªß m·∫°nh ƒë·ªÉ chuy·ªÉn th·∫ª
        if (diffX > 0) {
          // Swipe right - th·∫ª tr∆∞·ªõc
          cardEl.style.transform = 'translateX(100%) rotate(20deg)';
          cardEl.style.opacity = '0';
          setTimeout(() => {
            prevCard();
            resetCardPosition();
          }, 300);
        } else {
          // Swipe left - th·∫ª ti·∫øp theo
          cardEl.style.transform = 'translateX(-100%) rotate(-20deg)';
          cardEl.style.opacity = '0';
          setTimeout(() => {
            nextCard();
            resetCardPosition();
          }, 300);
        }
      } else {
        // Swipe kh√¥ng ƒë·ªß m·∫°nh - tr·ªü v·ªÅ v·ªã tr√≠ ban ƒë·∫ßu
        resetCardPosition();
      }
      
      isDragging = false;
      cardEl = null;
    }

    function resetCardPosition() {
      const card = document.getElementById('card');
      card.style.transform = 'translateX(0) rotate(0deg)';
      card.style.opacity = '1';
    }

    // Mouse events for desktop
    let mouseDown = false;
    let startMouseX = 0;
    let startMouseY = 0;

    document.getElementById('card').addEventListener('mousedown', (e) => {
      mouseDown = true;
      startMouseX = e.clientX;
      startMouseY = e.clientY;
      isDragging = false;
      cardEl = e.target.closest('.card');
    });

    document.addEventListener('mousemove', (e) => {
      if (!mouseDown || !cardEl) return;
      
      const diffX = e.clientX - startMouseX;
      const diffY = e.clientY - startMouseY;
      
      if (Math.abs(diffX) > Math.abs(diffY) && Math.abs(diffX) > 10) {
        isDragging = true;
        cardEl.style.transform = `translateX(${diffX}px) rotate(${diffX * 0.1}deg)`;
        cardEl.style.opacity = 1 - Math.abs(diffX) / 300;
      }
    });

    document.addEventListener('mouseup', (e) => {
      if (!mouseDown || !cardEl) return;
      
      const diffX = e.clientX - startMouseX;
      const threshold = 80;
      
      if (Math.abs(diffX) > threshold) {
        if (diffX > 0) {
          cardEl.style.transform = 'translateX(100%) rotate(20deg)';
          cardEl.style.opacity = '0';
          setTimeout(() => {
            prevCard();
            resetCardPosition();
          }, 300);
        } else {
          cardEl.style.transform = 'translateX(-100%) rotate(-20deg)';
          cardEl.style.opacity = '0';
          setTimeout(() => {
            nextCard();
            resetCardPosition();
          }, 300);
        }
      } else {
        resetCardPosition();
      }
      
      mouseDown = false;
      isDragging = false;
      cardEl = null;
    });

    // Keyboard navigation
    document.addEventListener('keydown', (e) => {
      if (e.key === 'ArrowLeft') {
        prevCard();
      } else if (e.key === 'ArrowRight') {
        nextCard();
      } else if (e.key === ' ' || e.key === 'Enter') {
        e.preventDefault();
        flipCard();
      }
    });

    // Sample data for demonstration
    const sampleData = [
      {
        word: "Serendipity",
        meaning: "S·ª± t√¨nh c·ªù may m·∫Øn",
        example: "Finding this book was pure serendipity."
      },
      {
        word: "Ephemeral",
        meaning: "T·∫°m th·ªùi, ph√π du",
        example: "The beauty of cherry blossoms is ephemeral."
      },
      {
        word: "Ubiquitous",
        meaning: "C√≥ m·∫∑t kh·∫Øp n∆°i",
        example: "Smartphones are ubiquitous in modern society."
      },
      {
        word: "Mellifluous",
        meaning: "Ng·ªçt ng√†o, du d∆∞∆°ng",
        example: "Her mellifluous voice captivated the audience."
      },
      {
        word: "Quintessential",
        meaning: "ƒêi·ªÉn h√¨nh, tinh t√∫y",
        example: "This painting is quintessential of the Renaissance period."
      },
      {
        word: "Quickly",
        meaning: "M·ªôt c√°ch nhanh ch√≥ng",
        example: "She ran quickly to catch the bus."
      },
      {
        word: "Beautiful",
        meaning: "ƒê·∫πp, xinh ƒë·∫πp",
        example: "The sunset was beautiful tonight."
      },
      {
        word: "Run",
        meaning: "Ch·∫°y, v·∫≠n h√†nh",
        example: "I like to run in the morning."
      },
      {
        word: "Happiness",
        meaning: "H·∫°nh ph√∫c, ni·ªÅm vui",
        example: "Money cannot buy happiness."
      },
      {
        word: "Through",
        meaning: "Qua, xuy√™n qua",
        example: "We walked through the forest."
      },
      {
        word: "Although",
        meaning: "M·∫∑c d√π, tuy r·∫±ng",
        example: "Although it rained, we still went out."
      },
      {
        word: "Wow",
        meaning: "√îi, th·∫≠t tuy·ªát",
        example: "Wow! That's amazing!"
      }
    ];

    // Initialize with sample data
    vocabulary = sampleData;
    shuffle(vocabulary);
    currentIndex = 0;
    loadCard(currentIndex);

    // Try to fetch data.json, fall back to sample data if not available
    fetch("data.json")
      .then(res => res.json())
      .then(data => {
        vocabulary = data;
        shuffle(vocabulary);
        currentIndex = 0;
        loadCard(currentIndex);
      })
      .catch(err => {
        console.log("S·ª≠ d·ª•ng d·ªØ li·ªáu m·∫´u v√¨ kh√¥ng t√¨m th·∫•y data.json");
        // Keep using sample data
      });
  </script>

</body>

</html>